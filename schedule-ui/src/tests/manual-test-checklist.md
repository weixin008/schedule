# 排班系统手动测试清单

## 🎯 测试目标
验证排班系统的核心功能是否正常工作，用户体验是否良好。

## 📋 测试环境
- 后端服务：http://localhost:9020
- 前端服务：http://localhost:9010
- 测试账户：admin / admin123

---

## 🔥 核心功能测试 (必须完成)

### 1. 登录和导航测试
- [x] ✅ 使用 admin/admin123 成功登录
- [x] ✅ 左侧菜单正常展开和收起
- [x] ✅ 各菜单项点击正常跳转
- [x] ✅ 面包屑导航显示正确 (页面顶部的导航路径，如：首页 > 人员管理 > 员工信息)
- [x] ✅ 退出登录功能正常

### 2. 仪表盘测试
- [x] ✅ 访问 `/dashboard`
- [x] ✅ 人员统计数据显示正确
- [x] ✅ 今日/明日值班信息显示
- [x] ✅ 系统状态监控正常
- [x] ✅ 快捷操作按钮可用

### 3. 人员管理测试 (已完成 ✅)
- [x] ✅ 访问 `/personnel/employees`
- [x] ✅ 添加测试员工 (字段：工号、姓名、入职日期、状态、电话)
- [x] ✅ 编辑员工信息
- [x] ✅ 测试员工状态变更功能：
  - [x] ✅ 在岗 ↔ 请假 (时间段：起始日期到终止日期，可选长期)
  - [x] ✅ 在岗 ↔ 出差 (时间段：起始日期到终止日期，可选长期)
  - [x] ✅ 在岗 ↔ 调动 (时间段：起始日期到终止日期，可选长期)
  - [x] ✅ 任意状态 → 离职 (记录离职日期)
  - [x] ✅ 非在岗状态 → 在岗 (清除时间段信息)
- [x] ✅ 验证状态时间显示正确 (表格中显示时间段或离职日期)
- [x] ✅ 测试长期状态选项
- [x] ✅ 删除测试员工

### 4. 组织架构管理测试 (全新功能 - 通用可视化架构图)
- [ ] 🔄 访问 `/personnel/departments` (组织架构管理)
- [ ] 🔄 创建根部门 (一级部门 - 总公司/总部)
- [ ] 🔄 创建通用部门层级结构：
  - [ ] 🔄 一级 → 二级 → 三级 → 四级 → 五级部门
  - [ ] 🔄 支持多个二级部门（如：人力资源部、技术部、销售部）
  - [ ] 🔄 每个部门内设置不同级别职位
- [ ] 🔄 可视化架构图功能：
  - [ ] 🔄 树形图清晰显示组织结构
  - [ ] 🔄 五个级别用不同颜色标识（紫→蓝→绿→橙→红）
  - [ ] 🔄 展开/收起功能正常
  - [ ] 🔄 架构图美观易读，适合各种组织类型
- [ ] 🔄 职位管理功能：
  - [ ] 🔄 点击部门"添加职位"
  - [ ] 🔄 设置职位名称、级别和最大人数
  - [ ] 🔄 职位以卡片形式显示在部门下方
  - [ ] 🔄 显示职位级别和人员配置状态
- [ ] 🔄 人员分配功能：
  - [ ] 🔄 点击职位"分配人员"
  - [ ] 🔄 多选员工分配到职位
  - [ ] 🔄 实时显示当前人数/最大人数
  - [ ] 🔄 人员满额时状态提示
- [ ] � 编辑和删除功能：
  - [ ] 🔄 编辑部门信息（名称、描述、级别）
  - [ ] 🔄 编辑职位信息（名称、级别、人数限制）
  - [ ] 🔄 删除空部门和职位
  - [ ] 🔄 有人员或子部门时正确阻止删除

### 5. 班次设置测试
- [ ] 访问 `/schedule/shifts`
- [ ] 查看预置班次 (早班、晚班、夜班、全天)
- [ ] 添加自定义班次
- [ ] 编辑班次时间
- [ ] 启用/禁用班次

### 6. 值班角色配置测试
- [ ] 访问 `/schedule/roles`
- [ ] 添加值班角色 (如：值班医生、值班护士)
- [ ] 设置筛选条件 (按标签、部门)
- [ ] 设置分配类型 (单人/编组)
- [ ] 启用/禁用角色

### 7. 排班规则管理测试
- [ ] 访问 `/schedule/rules`
- [ ] 创建简单排班规则
  - [ ] 选择轮换类型 (每日轮换)
  - [ ] 配置班次和角色
  - [ ] 设置约束条件
- [ ] 编辑规则
- [ ] 启用/禁用规则
- [ ] 删除规则

### 8. 智能排班测试 (核心功能)
- [ ] 访问 `/schedule/engine`
- [ ] 检查系统配置状态显示
  - [ ] 员工信息状态
  - [ ] 班次设置状态
  - [ ] 值班角色状态
  - [ ] 排班规则状态
- [ ] 选择排班规则
- [ ] 设置时间范围 (建议测试1周)
- [ ] 点击"开始生成"
- [ ] 检查前置条件检查是否正常
- [ ] 确认生成排班
- [ ] 查看生成结果和统计信息
- [ ] 检查是否有冲突提示

### 9. 排班日历测试
- [ ] 访问 `/schedule/calendar`
- [ ] 检查排班事件是否正确显示
- [ ] 测试视图切换
  - [ ] 月视图
  - [ ] 周视图
  - [ ] 日视图
- [ ] 检查事件颜色和样式
- [ ] 点击事件查看详情
- [ ] 测试快捷操作按钮

---

## ⚡ 扩展功能测试 (建议完成)

### 10. 系统监控测试 (管理员功能)
- [ ] 访问 `/system/monitor`
- [ ] 查看性能指标
- [ ] 查看缓存统计
- [ ] 测试清理过期缓存
- [ ] 查看系统日志

### 11. API测试工具
- [ ] 访问 `/api-test`
- [ ] 测试员工API
- [ ] 测试班次API
- [ ] 测试值班角色API
- [ ] 测试排班规则API

### 12. 人员批量导入测试
- [ ] 访问 `/personnel/import`
- [ ] 下载模板文件
- [ ] 上传测试数据
- [ ] 检查导入结果

---

## 📱 移动端测试 (重要)

### 13. 响应式设计测试
- [ ] 使用浏览器开发者工具切换到移动端视图
- [ ] 测试主要页面在小屏幕下的显示
- [ ] 检查菜单在移动端的表现
- [ ] 测试排班日历的移动端适配
- [ ] 检查按钮和表单在触摸设备上的可用性

---

## 🔍 性能和稳定性测试

### 14. 基础性能测试
- [ ] 页面加载速度 (应 < 2秒)
- [ ] API响应时间 (应 < 500ms)
- [ ] 大量数据下的表现 (添加50+员工测试)
- [ ] 长时间使用稳定性 (连续操作30分钟)

### 15. 错误处理测试
- [ ] 网络断开时的表现
- [ ] 无效数据输入的处理
- [ ] 权限不足时的提示
- [ ] 系统错误时的用户友好提示

---

## 🐛 已发现并修复的问题

### 问题 #1 ✅ 已修复
- **页面/功能**: 员工管理页面
- **问题描述**: isEditing变量重复声明导致编译错误
- **解决方案**: 删除重复的变量声明
- **状态**: 已修复

### 问题 #2 ✅ 已修复  
- **页面/功能**: 员工管理
- **问题描述**: 字段过多，缺少状态管理功能
- **解决方案**: 简化为核心字段，添加状态切换功能
- **状态**: 已优化

### 问题 #3 ✅ 已修复
- **页面/功能**: 部门管理
- **问题描述**: 功能简陋，不支持组织架构和职位层级
- **解决方案**: 重构为组织架构管理，支持部门层级和职位设置
- **状态**: 已重构

---

## 🐛 新问题记录模板

发现新问题时，请按以下格式记录：

```
### 问题 #X
- **页面/功能**: 
- **操作步骤**: 
- **预期结果**: 
- **实际结果**: 
- **严重程度**: 高/中/低
- **浏览器**: 
- **截图**: (如有)
```

---

## ✅ 测试完成标准

### 必须通过的测试
- [ ] 所有核心功能测试通过
- [ ] 智能排班完整流程正常
- [ ] 排班日历正确显示结果
- [ ] 移动端基本可用

### 可接受的问题
- 非核心功能的小问题
- 界面细节优化建议
- 性能优化建议

### 不可接受的问题
- 核心功能无法使用
- 数据丢失或错误
- 系统崩溃或无响应
- 安全漏洞

---

## 📊 测试报告模板

测试完成后，请提供简要报告：

```
# 排班系统测试报告

## 测试概况
- 测试时间: 
- 测试人员: 
- 测试环境: 
- 测试范围: 

## 测试结果
- 通过测试: X/Y
- 发现问题: X个 (高:X, 中:X, 低:X)
- 整体评价: 优秀/良好/需改进

## 主要问题
1. 
2. 
3. 

## 建议
1. 
2. 
3. 

## 结论
系统是否可以投入使用: 是/否
```

---

---

## 📋 测试进度总结

### ✅ 已完成测试 (3/15)
1. **登录和导航测试** - 全部通过 ✅
2. **仪表盘测试** - 全部通过 ✅
3. **人员管理测试** - 全部通过 ✅

### 🔄 待测试功能 (12/15)
4. **组织架构管理测试** - ✅ 已完成开发，支持通用可视化架构图，待测试
5. **班次设置测试** - 待测试
6. **值班角色配置测试** - 待测试
7. **排班规则管理测试** - 待测试
8. **智能排班测试** - 核心功能，待测试
9. **排班日历测试** - 待测试
10. **系统监控测试** - 待测试
11. **API测试工具** - 待测试
12. **人员批量导入测试** - 待测试
13. **响应式设计测试** - 待测试
14. **基础性能测试** - 待测试
15. **错误处理测试** - 待测试

### 🎯 下一步测试重点
建议按以下顺序继续测试：
1. **人员管理测试** - ✅ 已完成，支持时间段状态管理
2. **组织架构管理测试** - ✅ 已完成开发，现在可以开始测试
3. **智能排班测试** - 核心业务功能验证

### 🔧 当前状态
- 后端服务：已重新构建，数据库已重置
- 前端页面：组织架构管理页面已完成（通用化设计）
- 测试准备：可以开始进行组织架构功能测试

### 📋 组织架构测试要点
1. **通用性验证**：确认界面和功能适用于各行各业
2. **层级结构**：测试多级部门的创建和管理
3. **自定义能力**：验证用户可以完全自定义部门和岗位
4. **标签化管理**：确认部门和岗位作为标签便于后续使用

### 📝 人员管理功能说明 ✅
- **状态管理**: 支持在岗、请假、出差、调动、离职五种状态
- **时间段支持**: 请假/出差/调动支持起始日期到终止日期，可选择长期
- **离职处理**: 离职状态只需记录离职日期
- **状态变更**: 通过下拉菜单进行状态变更，弹窗确认时间段
- **显示优化**: 表格中清晰显示状态时间信息
- **测试结果**: 所有功能正常工作，状态变更和时间段管理完全符合需求

### 📝 组织架构管理功能说明 ✅ (通用化设计)
- **通用适配**: 适用于各行各业，用户可自定义部门和岗位
- **层级结构**: 支持多级部门结构，可设置上下级关系
- **标签管理**: 部门和岗位作为标签管理，便于后续排班使用
- **分栏布局**: 左侧部门管理，右侧岗位管理，界面清晰
- **灵活关联**: 岗位可以选择关联部门，也可以独立存在
- **级别管理**: 五级部门和岗位级别，颜色区分清晰
- **人员分配**: 可将员工分配到具体岗位，实时显示配置状态
- **完整CRUD**: 支持部门和岗位的创建、编辑、删除操作
- **智能约束**: 有人员分配时阻止删除，确保数据完整性
- **用户自定义**: 提供基础示例，用户可根据实际需要修改

---

*测试清单版本: v1.1*
*创建时间: 2025-01-25*
*最后更新: 2025-01-25*
-
--

## 🆕 值班角色配置功能测试 (新增)

### 16. 值班角色配置一站式功能测试
- [ ] 访问 `/schedule/roles` (值班角色配置页面)
- [ ] 页面正常加载，显示5步配置流程
- [ ] **步骤1: 基础信息配置**
  - [ ] 角色名称输入框正常
  - [ ] 角色描述文本域正常
  - [ ] 角色类型下拉选择 (日班/夜班/全天/轮班)
  - [ ] 优先级数字输入 (1-10)
  - [ ] 表单验证正常工作
  - [ ] "下一步"按钮状态正确
- [ ] **步骤2: 班次设置**
  - [ ] 默认显示一个早班配置
  - [ ] "添加班次"功能正常
  - [ ] 班次配置项完整：
    - [ ] 班次名称输入
    - [ ] 班次代码输入
    - [ ] 开始时间选择器
    - [ ] 结束时间选择器
    - [ ] 工作时长数字输入
    - [ ] 班次颜色选择器
  - [ ] "删除班次"功能正常 (保留至少一个)
  - [ ] 多个班次配置互不干扰
- [ ] **步骤3: 人员编组**
  - [ ] 默认显示一个A组配置
  - [ ] "添加编组"功能正常
  - [ ] "刷新人员列表"功能正常
  - [ ] 编组配置项完整：
    - [ ] 编组名称输入
    - [ ] 人员选择器 (Transfer组件)
    - [ ] 最小人数设置
    - [ ] 最大人数设置
  - [ ] "删除编组"功能正常 (保留至少一个)
  - [ ] 人员分配逻辑正确
- [ ] **步骤4: 排班规则**
  - [ ] 基础规则标签页：
    - [ ] 排班周期选择 (按周/按月/自定义)
    - [ ] 轮换方式选择 (顺序/随机/负载均衡)
    - [ ] 连续工作天数设置
    - [ ] 最小休息间隔设置
  - [ ] 约束条件标签页：
    - [ ] 工作日限制复选框组
    - [ ] 节假日处理单选组
    - [ ] 特殊要求文本域
- [ ] **步骤5: 预览确认**
  - [ ] 配置总览标签页：
    - [ ] 角色基础信息显示正确
    - [ ] 班次配置信息显示正确
    - [ ] 编组配置信息显示正确
  - [ ] 排班预览标签页：
    - [ ] 预览日期选择器正常
    - [ ] "生成预览"按钮功能正常
    - [ ] 预览表格显示正确
    - [ ] 班次人员分配显示正确
- [ ] **步骤导航功能**
  - [ ] 步骤指示器显示正确
  - [ ] 点击步骤可跳转 (已完成步骤)
  - [ ] "上一步"/"下一步"按钮正常
  - [ ] 步骤验证逻辑正确
- [ ] **数据保存功能**
  - [ ] "保存配置"按钮正常
  - [ ] 保存成功提示
  - [ ] 数据持久化正确
  - [ ] 保存后跳转正确
- [ ] **表单重置功能**
  - [ ] "重置"按钮正常
  - [ ] 重置确认对话框
  - [ ] 重置后数据恢复默认值
- [ ] **响应式设计**
  - [ ] 桌面端显示正常
  - [ ] 平板端适配良好
  - [ ] 手机端基本可用
- [ ] **用户体验**
  - [ ] 页面加载速度快
  - [ ] 操作流程直观
  - [ ] 错误提示清晰
  - [ ] 成功反馈及时

### 17. 值班角色配置API测试
- [ ] 使用浏览器控制台运行测试脚本
- [ ] 加载测试脚本: `/src/tests/shift-role-api-test.js`
- [ ] 运行 `runTests()` 完整测试
- [ ] 验证以下API接口：
  - [ ] GET `/api/employees` - 获取员工列表
  - [ ] POST `/api/shift-roles` - 创建值班角色
  - [ ] GET `/api/shift-roles` - 获取值班角色列表
  - [ ] POST `/api/simplified-schedule-engine/preview` - 生成排班预览
  - [ ] DELETE `/api/shift-roles/:id` - 删除值班角色
- [ ] 检查API响应时间和数据格式
- [ ] 验证错误处理机制

### 18. 值班角色配置集成测试
- [ ] 创建完整的值班角色配置
- [ ] 在排班日历中查看配置结果
- [ ] 在智能排班中使用该角色
- [ ] 验证数据一致性
- [ ] 测试配置修改后的影响

---

## 📊 更新后的测试进度总结

### ✅ 已完成测试 (3/18)
1. **登录和导航测试** - 全部通过 ✅
2. **仪表盘测试** - 全部通过 ✅
3. **人员管理测试** - 全部通过 ✅

### 🔄 待测试功能 (15/18)
4. **组织架构管理测试** - ✅ 已完成开发，待测试
5. **班次设置测试** - 待测试
6. **值班角色配置测试** - 🆕 新功能，待测试
7. **排班规则管理测试** - 待测试
8. **智能排班测试** - 核心功能，待测试
9. **排班日历测试** - 待测试
10. **系统监控测试** - 待测试
11. **API测试工具** - 待测试
12. **人员批量导入测试** - 待测试
13. **响应式设计测试** - 待测试
14. **基础性能测试** - 待测试
15. **错误处理测试** - 待测试
16. **值班角色配置功能测试** - 🆕 新增，待测试
17. **值班角色配置API测试** - 🆕 新增，待测试
18. **值班角色配置集成测试** - 🆕 新增，待测试

### 🎯 下一步测试重点
建议按以下顺序继续测试：
1. **值班角色配置功能测试** - 🆕 新开发的一站式配置功能
2. **值班角色配置API测试** - 验证后端接口正常工作
3. **智能排班测试** - 使用新配置进行排班验证

### 🔧 当前状态
- 后端服务：已添加简化排班引擎
- 前端页面：值班角色配置页面已完成重构
- 测试准备：可以开始进行值班角色配置功能测试
- API接口：已提供测试脚本

### 📝 值班角色配置功能说明 🆕
- **一站式配置**: 将班次设置、编组管理、排班规则整合到一个页面
- **5步配置流程**: 基础信息 → 班次设置 → 人员编组 → 排班规则 → 预览确认
- **智能验证**: 每步都有表单验证，确保数据完整性
- **实时预览**: 第5步可以预览排班效果
- **响应式设计**: 支持桌面端、平板端、手机端
- **用户友好**: 步骤导航、进度指示、操作引导
- **数据持久化**: 配置保存到数据库，支持后续修改
- **API集成**: 与简化排班引擎无缝集成

---

*测试清单版本: v1.2*
*最后更新: 2025-01-25 (新增值班角色配置功能测试)*